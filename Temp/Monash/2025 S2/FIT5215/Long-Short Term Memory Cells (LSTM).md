---
date: 2025-10-01
author:
  - Siyuan Liu
tags:
  - FIT5215
---
**核心思想：**
- 引入**细胞状态** ct，提供**线性路径**
- 使用**门控机制**控制信息流动
- 梯度可以通过细胞状态**不衰减地**传播
```
┌──────────────────────────────────────────────────────────┐
│                    LSTM Cell                              │
├──────────────────────────────────────────────────────────┤
│ 1. 细胞状态 (Cell State): c_t                            │
│    - 长期记忆的载体                                       │
│    - 信息的"高速公路"                                     │
│                                                           │
│ 2. 隐藏状态 (Hidden State): h_t                          │
│    - 短期记忆                                             │
│    - 输出给下一层                                         │
│                                                           │
│ 3. 三个门 (Gates):                                       │
│    - 遗忘门 (Forget Gate): f_t                           │
│    - 输入门 (Input Gate): i_t                            │
│    - 输出门 (Output Gate): o_t                           │
└──────────────────────────────────────────────────────────┘
```
![[Pasted image 20251004160024.png]]

**数学公式:**
![[Pasted image 20251001165505.png]]
$$ \begin{align} 
g_t &=tanh⁡(h_{t−1}W+xtU+b)\\
f_t &= σ(x_tU^f+h_{t−1}W^f+b^f) \\ 
i_t &= σ(x_tU^i+h_{t−1}W^i+b^i) \\ 
c_t &= f_t \odot c_{t-1} + g_t \odot i_t \quad \\ 
o_t &= σ(x_tU^o+h_{t−1}W^o+b^o) \\ 
h_t &= o_t \odot \tanh(c_t)\\
\hat{y} &=h_tV + c\; / \; \operatorname{softmax}(h_tV+c)
\end{align} $$
- $g_t$:生成候选的新信息，范围在 (−1,1)
- $f_t$: 决定从 $c_{t-1}$ 中遗忘多少(∈(0,1)), 接近 0忘记这部分信息, 接近 1保留这部分信息
- $i_t$: 决定接受多少新信息 $g_t$, 与遗忘门配合，决定细胞状态的更新
- $c_t$: 组合旧信息（遗忘后）和新信息（输入门筛选后）
	- $f_t⊙c_{t−1}$：保留的旧记忆
	- $g_t⊙i_t$：添加的新记忆
- $o_t$: 决定输出多少细胞状态信息
	- - 控制有多少**长期记忆** ct 应该暴露给当前的**短期状态** ht
	- 防止无关信息干扰当前任务
- $h_t$: 最终的隐藏状态：输出门控制的细胞状态
	- $tanh⁡(c_t)$：将细胞状态压缩到 (−1,1)
	- $o_t⊙tanh⁡(c_t)$：选择性输出