---
date: 2025-10-04
author:
  - Siyuan Liu
tags:
  - FIT5215
---
**理解：**
在序列生成任务中，模型需要从大量可能的序列中选择最优的输出。Beam Search 是一种**折中策略**
- **贪心搜索 (Greedy Search)**：每步只保留概率最高的 1 个候选 → 容易陷入局部最优
- **穷举搜索 (Exhaustive Search)**：考虑所有可能的序列 → 计算量爆炸
- **Beam Search**：每步保留概率最高的 **k** 个候选 → 平衡质量和效率

```
输入（英文）: "I love AI"
输出（中文）：["我", "爱", "AI", "喜欢", "人工智能", "<END>"]


Beam Width k = 2


Decoder 输出概率：
"我":   0.6  ✅
"爱":   0.2
"喜欢": 0.15 ✅
"AI":   0.05

保留 k=2 个候选：
候选 1: ["我"]      (累积概率: 0.6)
候选 2: ["喜欢"]    (累积概率: 0.15)


# 生成第一个词
"我" → "爱":   0.6 × 0.7 = 0.42  ✅
"我" → "喜欢": 0.6 × 0.2 = 0.12
"我" → "AI":   0.6 × 0.05 = 0.03
"我" → "<END>": 0.6 × 0.05 = 0.03

"喜欢" → "AI":   0.15 × 0.5 = 0.075 ✅
"喜欢" → "人工智能": 0.15 × 0.3 = 0.045
"喜欢" → "爱":   0.15 × 0.1 = 0.015
"喜欢" → "<END>": 0.15 × 0.1 = 0.015

# 合并第一个词所有扩展，保留 k=2
所有候选序列（共 2×4 = 8 个）:
["我", "爱"]           0.42  ✅ (排名1)
["我", "喜欢"]         0.12
["我", "AI"]           0.03
["我", "<END>"]        0.03
["喜欢", "AI"]         0.075 ✅ (排名2)
["喜欢", "人工智能"]   0.045
["喜欢", "爱"]         0.015
["喜欢", "<END>"]      0.015

保留:
候选 1: ["我", "爱"]      (累积概率: 0.42)
候选 2: ["喜欢", "AI"]    (累积概率: 0.075)
```